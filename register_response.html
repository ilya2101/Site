<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Регистрация</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
          crossorigin="anonymous">
    <!-- Bootstrap Icons -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        :root {
            --primary-orange: #FF6B35;
            --orange-dark: #E55A2B;
            --orange-light: #FF8C42;
            --accent-green: #27AE60;
            --green-dark: #219653;
            --green-light: #6FCF97;
            --dark-bg: #1A1A1A;
            --text-light: #FFFFFF;
            --text-muted: #B0B0B0;
            --error-red: #e74c3c;
            --warning-orange: #ff8c00;
            --info-blue: #3498db;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
            color: #f0f0f0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        .navbar {
            background: linear-gradient(135deg, #000000 0%, #111111 100%) !important;
            box-shadow: 0 2px 15px rgba(255, 140, 0, 0.2);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 140, 0, 0.1);
        }

        .navbar-brand {
            font-weight: 800;
            font-size: 2rem;
            color: var(--primary-orange) !important;
            text-shadow: 0 0 10px rgba(255, 107, 53, 0.5);
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }

        .navbar-brand:hover {
            transform: translateY(-2px);
            text-shadow: 0 0 15px rgba(255, 107, 53, 0.7);
        }

        .navbar-brand small {
            font-size: 0.75rem;
            color: var(--text-muted);
            display: block;
            font-weight: 400;
            margin-top: -5px;
            letter-spacing: 0.5px;
        }

        .nav-link {
            font-weight: 500;
            transition: all 0.3s ease;
            color: var(--text-light) !important;
            padding: 0.5rem 1rem !important;
            border-radius: 8px;
            margin: 0 0.1rem;
        }

        .nav-link:hover {
            color: var(--primary-orange) !important;
            transform: translateY(-2px);
            text-shadow: 0 0 8px rgba(255, 107, 53, 0.7);
            background: rgba(255, 107, 53, 0.1);
        }

        .nav-link.active {
            color: var(--primary-orange) !important;
            background: rgba(255, 107, 53, 0.15);
        }

        .dropdown-menu {
            border: 1px solid rgba(255, 107, 53, 0.2);
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
            background: linear-gradient(135deg, #1a1a1a 0%, #222222 100%);
            padding: 0.5rem;
            margin-top: 0.5rem;
            animation: fadeIn 0.2s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dropdown-item {
            transition: all 0.3s ease;
            color: var(--text-light);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            margin: 0.1rem 0;
            display: flex;
            align-items: center;
        }

        .dropdown-item:hover {
            background: linear-gradient(90deg, var(--primary-orange) 0%, var(--orange-light) 100%);
            color: #000 !important;
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
        }

        .dropdown-item i {
            width: 20px;
            margin-right: 10px;
        }

        .dropdown-divider {
            border-color: rgba(255, 255, 255, 0.1);
            margin: 0.5rem 0;
        }

        .alert {
            border: none;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            position: relative;
            padding: 1rem 1.25rem 1rem 3.5rem;
            margin-bottom: 1rem;
            animation: slideIn 0.3s ease-out;
            border-left: 4px solid transparent;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .alert::before {
            content: '';
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.25rem;
        }

        .alert-success {
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--green-dark) 100%);
            color: white;
            border-left-color: var(--green-light);
        }

        .alert-success::before {
            content: '✓';
        }

        .alert-danger,
        .alert-error {
            background: linear-gradient(135deg, var(--error-red) 0%, #c0392b 100%);
            color: white;
            border-left-color: #ff8c8c;
        }

        .alert-danger::before,
        .alert-error::before {
            content: '✗';
        }

        .alert-warning {
            background: linear-gradient(135deg, var(--warning-orange) 0%, #ff6a00 100%);
            color: white;
            border-left-color: #ffb366;
        }

        .alert-warning::before {
            content: '⚠';
        }

        .alert-info {
            background: linear-gradient(135deg, var(--info-blue) 0%, #2980b9 100%);
            color: white;
            border-left-color: #85c1e9;
        }

        .alert-info::before {
            content: 'ⓘ';
        }

        .alert-dismissible {
            padding-right: 3.5rem;
        }

        .alert-dismissible .btn-close {
            position: absolute;
            top: 50%;
            right: 1rem;
            transform: translateY(-50%);
            padding: 0.5rem;
            filter: invert(1);
            opacity: 0.8;
            transition: all 0.3s ease;
        }

        .alert-dismissible .btn-close:hover {
            opacity: 1;
            transform: translateY(-50%) rotate(90deg);
        }

        .navbar-toggler {
            border: 2px solid var(--primary-orange);
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .navbar-toggler:hover {
            background: rgba(255, 107, 53, 0.1);
            transform: scale(1.05);
        }

        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 107, 53, 1%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
            width: 1.25em;
            height: 1.25em;
        }

        .text-warning {
            color: var(--warning-orange) !important;
        }

        .text-primary {
            color: var(--primary-orange) !important;
        }

        main {
            padding: 2rem 0;
            min-height: calc(100vh - 200px);
        }

        /* Анимация для flash сообщений */
        @keyframes fadeOut {
            to { opacity: 0; transform: translateY(-10px); }
        }

        .alert.fade-out {
            animation: fadeOut 0.5s ease-out forwards;
        }

        /* Адаптивность */
        @media (max-width: 768px) {
            .navbar-brand {
                font-size: 1.5rem;
            }

            .navbar-brand small {
                font-size: 0.7rem;
            }

            .nav-link {
                padding: 0.75rem 1rem !important;
                margin: 0.2rem 0;
            }

            .alert {
                padding: 0.875rem 1rem 0.875rem 3rem;
                font-size: 0.9rem;
            }

            .alert::before {
                left: 0.875rem;
                font-size: 1.1rem;
            }

            main {
                padding: 1.5rem 0;
            }
        }

        @media (max-width: 576px) {
            .container {
                padding-left: 1rem;
                padding-right: 1rem;
            }

            .navbar-brand {
                font-size: 1.25rem;
            }

            .alert {
                margin-left: 0.5rem;
                margin-right: 0.5rem;
                border-radius: 10px;
            }
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark sticky-top">
    <div class="container">
        <a class="navbar-brand" href="/service/">
            <i class="bi bi-tools me-2"></i>ADRAuto
            <small>Профессиональный автосервис</small>
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
            <!-- Основное меню -->
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link "
                       href="/service/about">
                        <i class="bi bi-info-circle me-1"></i>О нас
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link "
                       href="/service/discounts">
                        <i class="bi bi-percent me-1"></i>Акции
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link "
                       href="/service/price">
                        <i class="bi bi-currency-dollar me-1"></i>Цены
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link "
                       href="/service/contacts">
                        <i class="bi bi-telephone me-1"></i>Контакты
                    </a>
                </li>
            </ul>

            <!-- Пользовательское меню -->
            <ul class="navbar-nav ms-auto">
                
                <!-- Показываем для неавторизованных пользователей -->
                <li class="nav-item">
                    <a class="nav-link "
                       href="/service/login">
                        <i class="bi bi-box-arrow-in-right me-1"></i>Войти
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active"
                       href="/service/register">
                        <i class="bi bi-person-plus me-1"></i>Регистрация
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</nav>

<!-- Flash сообщения -->
<div class="container mt-3">
    
    
    <div class="messages-container">
        
        <div class="alert alert-danger alert-dismissible fade show"
             role="alert" data-autohide="false">
            <strong>
                
                Ошибка:
                
            </strong>
            Ошибка: номер телефона уже занят
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Закрыть"></button>
        </div>
        
    </div>
    
    
</div>

<main>
    
<main class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6 col-md-8">
                <div class="register-card animate-fade-up">
                    <!-- Заголовок -->
                    <div class="register-header">
                        <div class="register-icon">
                            <i class="bi bi-person-plus-fill"></i>
                        </div>
                        <h2 class="register-title">Регистрация</h2>
                        <p class="register-subtitle">Создайте аккаунт в ADRAuto</p>
                    </div>

                    <div class="register-body">
                        <!-- Flash сообщения -->
                        
                        
                        
                        <div class="modern-alert alert-success animate-fade-in">
                            <i class="bi bi-check-circle me-2"></i>
                            Ошибка: номер телефона уже занят
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                        
                        
                        

                        <form action="/service/register" method="POST" id="registerForm">
                            <!-- Имя -->
                            <div class="mb-3">
                                <label class="input-label">Имя *</label>
                                <div class="input-with-icon">
                                    <div class="input-icon">
                                        <i class="bi bi-person-fill"></i>
                                    </div>
                                    <input type="text"
                                           class="form-input "
                                           id="first_name"
                                           name="first_name"
                                           value=""
                                           required
                                           maxlength="30"
                                           placeholder="Иван">
                                </div>
                                
                                <small class="form-hint">Только русские буквы (2-30 символов)</small>
                            </div>

                            <!-- Фамилия -->
                            <div class="mb-3">
                                <label class="input-label">Фамилия *</label>
                                <div class="input-with-icon">
                                    <div class="input-icon">
                                        <i class="bi bi-person-badge-fill"></i>
                                    </div>
                                    <input type="text"
                                           class="form-input "
                                           id="last_name"
                                           name="last_name"
                                           value=""
                                           required
                                           maxlength="30"
                                           placeholder="Иванов">
                                </div>
                                
                                <small class="form-hint">Только русские буквы (2-30 символов)</small>
                            </div>

                            <!-- Номер телефона -->
                            <div class="mb-3">
                                <label class="input-label">Номер телефона *</label>
                                <div class="input-with-icon">
                                    <div class="input-icon">
                                        <i class="bi bi-telephone-fill"></i>
                                    </div>
                                    <input type="tel"
                                           class="form-input "
                                           id="phone"
                                           name="phone"
                                           value="+7"
                                           required
                                           maxlength="16"
                                           placeholder="+71234567890">
                                </div>
                                
                                <small class="form-hint">Формат: +7XXXXXXXXXX (11 цифр)</small>
                            </div>

                            <!-- Email -->
                            <div class="mb-3">
                                <label class="input-label">Email *</label>
                                <div class="input-with-icon">
                                    <div class="input-icon">
                                        <i class="bi bi-envelope-fill"></i>
                                    </div>
                                    <input type="email"
                                           class="form-input "
                                           id="email"
                                           name="email"
                                           value=""
                                           required
                                           maxlength="50"
                                           placeholder="example@mail.ru">
                                </div>
                                
                                <small class="form-hint">Допустимые домены: @mail.ru, @gmail.com, @yandex.ru, @vk.com</small>
                            </div>

                            <!-- Пароль -->
                            <div class="mb-3">
                                <label class="input-label">Пароль *</label>
                                <div class="input-with-icon">
                                    <div class="input-icon">
                                        <i class="bi bi-shield-lock-fill"></i>
                                    </div>
                                    <input type="password"
                                           class="form-input "
                                           id="password"
                                           name="password"
                                           minlength="8"
                                           maxlength="50"
                                           required
                                           placeholder="Минимум 8 символов">
                                </div>
                                
                                <small class="form-hint">
                                    Должен содержать: заглавные и строчные буквы, цифры, специальные символы
                                </small>
                            </div>

                            <!-- Подтверждение пароля -->
                            <div class="mb-3">
                                <label class="input-label">Подтверждение пароля *</label>
                                <div class="input-with-icon">
                                    <div class="input-icon">
                                        <i class="bi bi-shield-check"></i>
                                    </div>
                                    <input type="password"
                                           class="form-input "
                                           id="confirm_password"
                                           name="confirm_password"
                                           required
                                           placeholder="Повторите пароль">
                                </div>
                                
                            </div>

                            <!-- Согласие с условиями -->
                            <div class="mb-4">
                                <div class="form-check">
                                    <input type="checkbox"
                                           class="form-check-input "
                                           id="agree_terms"
                                           name="agree_terms"
                                           checked>
                                    <label class="form-check-label" for="agree_terms">
                                        Я согласен с условиями использования *
                                    </label>
                                </div>
                                
                            </div>

                            <!-- Кнопка отправки -->
                            <button type="submit" class="btn-modern-primary w-100" id="submitBtn">
                                <i class="bi bi-person-plus me-2"></i>Зарегистрироваться
                            </button>

                            <!-- Индикатор загрузки -->
                            <div class="loading-indicator" id="loadingIndicator" style="display: none;">
                                <div class="spinner"></div>
                                <span>Обработка...</span>
                            </div>
                        </form>

                        <!-- Ссылка на вход -->
                        <div class="register-footer">
                            <p class="text-muted text-center mb-0">
                                Уже есть аккаунт?
                                <a href="/service/login" class="register-link">Войти</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<style>
    /* СТАНДАРТИЗИРОВАННЫЕ СТИЛИ ПО ДИЗАЙН-СИСТЕМЕ */
    :root {
        --primary-orange: #FF6B35;
        --orange-dark: #E55A2B;
        --orange-light: #FF8C42;
        --accent-green: #27AE60;
        --green-dark: #219653;
        --green-light: #6FCF97;
        --dark-bg: #1A1A1A;
        --card-bg: #2D2D2D;
        --text-light: #FFFFFF;
        --text-muted: #B0B0B0;
        --input-bg: rgba(40, 40, 40, 0.8);
        --input-border: #4A4A4A;
        --input-focus-border: #FF6B35;
        --input-error-border: #FF4757;
        --input-text: #FFFFFF;
        --input-placeholder: #888888;
        --icon-bg: #FF6B35;
        --icon-color: #FFFFFF;
        --gradient-primary: linear-gradient(135deg, var(--primary-orange) 0%, var(--orange-light) 100%);
        --gradient-accent: linear-gradient(135deg, var(--accent-green) 0%, var(--green-light) 100%);
        --gradient-card: linear-gradient(145deg, #2D2D2D 0%, #3A3A3A 100%);
        --error-color: #FF6B6B;
        --success-color: #27AE60;
        --warning-color: #FFA726;
    }

    /* КАРТОЧКА РЕГИСТРАЦИИ */
    .register-card {
        background: var(--gradient-card);
        border-radius: 20px;
        box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        overflow: hidden;
        border: 1px solid rgba(255, 107, 53, 0.3);
        position: relative;
        max-width: 550px;
        margin: 0 auto;
    }

    .register-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 5px;
        background: var(--gradient-primary);
        box-shadow: 0 3px 10px rgba(255, 107, 53, 0.4);
    }

    .register-header {
        background: linear-gradient(135deg, #2A2A2A 0%, #222222 100%);
        padding: 2.5rem 2rem 2rem;
        text-align: center;
        color: var(--text-light);
        border-bottom: 1px solid rgba(255, 107, 53, 0.2);
    }

    .register-icon {
        width: 70px;
        height: 70px;
        background: var(--gradient-primary);
        border-radius: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        color: white;
        margin: 0 auto 1.5rem;
        box-shadow: 0 8px 20px rgba(255, 107, 53, 0.4);
        transition: all 0.3s ease;
    }

    .register-card:hover .register-icon {
        transform: scale(1.05);
    }

    .register-title {
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: 0.5px;
    }

    .register-subtitle {
        color: var(--text-muted);
        margin: 0;
        font-size: 0.95rem;
        font-weight: 400;
    }

    .register-body {
        padding: 2.5rem 2rem;
        background: transparent;
    }

    /* ФОРМЫ */
    .input-label {
        display: block;
        color: var(--text-light);
        font-weight: 600;
        font-size: 1rem;
        margin-bottom: 0.8rem;
        letter-spacing: 0.3px;
    }

    .form-hint {
        display: block;
        color: var(--text-muted);
        font-size: 0.85rem;
        margin-top: 0.4rem;
        font-weight: 400;
    }

    .input-with-icon {
        position: relative;
        width: 100%;
    }

    .input-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        width: 2.5rem;
        height: 2.5rem;
        background: var(--gradient-primary);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--icon-color);
        font-size: 1.1rem;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
        z-index: 2;
    }

    .form-input {
        width: 100%;
        padding: 1.2rem 1.2rem 1.2rem 4.5rem;
        border: 2px solid var(--input-border);
        border-radius: 12px;
        font-size: 1rem;
        transition: all 0.3s ease;
        background: var(--input-bg);
        color: var(--input-text);
        font-weight: 500;
        letter-spacing: 0.3px;
    }

    .form-input.input-error {
        border-color: var(--input-error-border);
        background: rgba(255, 107, 107, 0.05);
    }

    .form-input::placeholder {
        color: var(--input-placeholder);
        font-weight: 400;
        opacity: 0.7;
    }

    .form-input:focus {
        border-color: var(--input-focus-border);
        box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
        background: rgba(45, 45, 45, 0.9);
        outline: none;
        transform: translateY(-2px);
    }

    .form-input:focus:not(.input-error) + .input-icon {
        background: var(--gradient-accent);
        transform: translateY(-50%) scale(1.05);
        box-shadow: 0 6px 15px rgba(255, 107, 53, 0.4);
    }

    /* СООБЩЕНИЯ ОБ ОШИБКАХ И УСПЕХЕ */
    .form-error {
        color: var(--error-color);
        font-weight: 500;
        font-size: 0.9rem;
        padding: 0.5rem 0.8rem;
        background: rgba(255, 107, 107, 0.1);
        border-radius: 8px;
        border-left: 3px solid var(--error-color);
        margin-top: 0.5rem;
        animation: slideIn 0.3s ease;
        display: flex;
        align-items: center;
    }

    .input-error-check {
        border-color: var(--error-color) !important;
    }

    .form-check {
        padding-left: 1.8rem;
    }

    .form-check-input {
        width: 1.2rem;
        height: 1.2rem;
        margin-top: 0.3rem;
        margin-left: -1.8rem;
        background-color: var(--input-bg);
        border: 2px solid var(--input-border);
        border-radius: 4px;
    }

    .form-check-input:checked {
        background-color: var(--primary-orange);
        border-color: var(--primary-orange);
    }

    .form-check-input:focus {
        box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
        border-color: var(--input-focus-border);
    }

    .form-check-label {
        color: var(--text-light);
        font-weight: 500;
        font-size: 0.95rem;
        cursor: pointer;
    }

    /* КНОПКА */
    .btn-modern-primary {
        background: var(--gradient-primary);
        border: none;
        padding: 1.4rem 2.5rem;
        border-radius: 12px;
        color: white;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        margin-top: 0.5rem;
        letter-spacing: 0.5px;
        box-shadow: 0 6px 20px rgba(255, 107, 53, 0.3);
    }

    .btn-modern-primary:hover:not(:disabled) {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(255, 107, 53, 0.4);
        background: var(--gradient-primary);
    }

    .btn-modern-primary:active:not(:disabled) {
        transform: translateY(-1px);
    }

    .btn-modern-primary:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none !important;
    }

    /* ИНДИКАТОР ЗАГРУЗКИ */
    .loading-indicator {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 1rem;
        margin-top: 1rem;
        color: var(--primary-orange);
        font-weight: 500;
        animation: fadeIn 0.3s ease;
    }

    .spinner {
        width: 1.5rem;
        height: 1.5rem;
        border: 3px solid rgba(255, 107, 53, 0.3);
        border-radius: 50%;
        border-top-color: var(--primary-orange);
        animation: spin 1s linear infinite;
        margin-right: 0.5rem;
    }

    /* СООБЩЕНИЯ */
    .modern-alert {
        border: none;
        border-radius: 12px;
        padding: 1.25rem 3rem 1.25rem 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        font-weight: 500;
        position: relative;
    }

    .alert-danger {
        background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        color: white;
        border-left: 4px solid #ff8c8c;
    }

    .alert-success {
        background: linear-gradient(135deg, var(--accent-green) 0%, var(--green-dark) 100%);
        color: white;
        border-left: 4px solid var(--green-light);
    }

    .btn-close {
        filter: invert(1);
        opacity: 0.8;
        transition: opacity 0.3s ease;
        position: absolute;
        right: 1rem;
        top: 50%;
        transform: translateY(-50%);
    }

    .btn-close:hover {
        opacity: 1;
    }

    /* ФУТЕР */
    .register-footer {
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding-top: 1.5rem;
        margin-top: 1.5rem;
        text-align: center;
    }

    .register-link {
        color: var(--primary-orange);
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s ease;
    }

    .register-link:hover {
        color: var(--orange-light);
        text-decoration: underline;
    }

    /* АНИМАЦИИ */
    .animate-fade-in {
        opacity: 0;
        animation: fadeInUp 0.6s forwards;
    }

    .animate-fade-up {
        opacity: 0;
        transform: translateY(20px);
        animation: fadeInUp 0.8s forwards;
    }

    @keyframes fadeInUp {
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateX(-10px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    @keyframes spin {
        to {
            transform: rotate(360deg);
        }
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }

    /* АДАПТИВНОСТЬ */
    @media (max-width: 768px) {
        .register-card {
            margin: 1rem;
            border-radius: 18px;
        }

        .register-header {
            padding: 2rem 1.5rem 1.5rem;
        }

        .register-body {
            padding: 2rem 1.5rem;
        }

        .register-icon {
            width: 60px;
            height: 60px;
            font-size: 1.6rem;
        }

        .register-title {
            font-size: 1.6rem;
        }

        .form-input {
            padding: 1.1rem 1rem 1.1rem 4rem;
            font-size: 0.95rem;
        }

        .input-icon {
            width: 2.2rem;
            height: 2.2rem;
            font-size: 1rem;
            left: 0.8rem;
        }

        .btn-modern-primary {
            padding: 1.2rem 2rem;
            font-size: 0.95rem;
        }

        .form-check-label {
            font-size: 0.9rem;
        }
    }

    @media (max-width: 480px) {
        .register-header {
            padding: 1.5rem 1rem 1rem;
        }

        .register-body {
            padding: 1.5rem 1rem;
        }

        .register-icon {
            width: 55px;
            height: 55px;
            font-size: 1.4rem;
        }

        .register-title {
            font-size: 1.5rem;
        }

        .form-input {
            padding: 1rem 0.8rem 1rem 3.5rem;
        }

        .input-icon {
            width: 2rem;
            height: 2rem;
            font-size: 0.9rem;
            left: 0.6rem;
        }

        .input-label {
            font-size: 0.9rem;
            margin-bottom: 0.6rem;
        }

        .btn-modern-primary {
            padding: 1.1rem 1.5rem;
            font-size: 0.9rem;
        }

        .modern-alert {
            padding: 1rem 2.5rem 1rem 1.25rem;
            font-size: 0.9rem;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('registerForm');
        const passwordInput = document.getElementById('password');
        const confirmPasswordInput = document.getElementById('confirm_password');
        const submitBtn = document.getElementById('submitBtn');
        const phoneInput = document.getElementById('phone');

        // Функция для блокировки не-русских символов
        function allowOnlyRussianLetters(event) {
            const key = event.key;
            const isRussianLetter = /^[А-Яа-яЁё]$/.test(key);
            const isControlKey = event.ctrlKey || event.altKey || event.metaKey;
            const isSpecialKey = [
                'Backspace', 'Delete', 'Tab', 'Escape', 'Enter',
                'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown',
                'Home', 'End', 'PageUp', 'PageDown'
            ].includes(key);

            // Разрешаем только русские буквы и управляющие клавиши
            if (!isRussianLetter && !isControlKey && !isSpecialKey && key.length === 1) {
                event.preventDefault();
                return false;
            }
            return true;
        }

        // Блокировка ввода не-русских букв для имени и фамилии
        const nameInputs = ['first_name', 'last_name'];
        nameInputs.forEach(id => {
            const input = document.getElementById(id);

            // Блокировка при вводе с клавиатуры
            input.addEventListener('keypress', allowOnlyRussianLetters);

            // Блокировка при вставке (paste)
            input.addEventListener('paste', function(e) {
                e.preventDefault();
                let pastedText = (e.clipboardData || window.clipboardData).getData('text');

                // Оставляем только русские буквы
                pastedText = pastedText.replace(/[^А-Яа-яЁё]/g, '');

                // Вставляем отфильтрованный текст
                const start = this.selectionStart;
                const end = this.selectionEnd;
                this.value = this.value.substring(0, start) + pastedText + this.value.substring(end);
                this.setSelectionRange(start + pastedText.length, start + pastedText.length);
            });

            // Автоматическое форматирование при потере фокуса
            input.addEventListener('blur', function() {
                let value = this.value.trim();

                // Удаляем все не-русские символы
                value = value.replace(/[^А-Яа-яЁё]/g, '');

                if (value.length >= 2) {
                    // Форматирование: первая буква заглавная, остальные строчные
                    this.value = value.charAt(0).toUpperCase() + value.slice(1).toLowerCase();
                } else {
                    this.value = value;
                }
            });
        });

        // Автоматическое форматирование телефона
        phoneInput.addEventListener('input', function(e) {
            let value = this.value.replace(/\D/g, '');

            // Если начинается с 8, меняем на 7
            if (value.startsWith('8')) {
                value = '7' + value.substring(1);
            }

            // Если начинается не с 7 и не пусто, добавляем 7
            if (value && !value.startsWith('7')) {
                value = '7' + value;
            }

            // Ограничиваем длину (11 цифр с кодом страны)
            if (value.length > 11) {
                value = value.substring(0, 11);
            }

            // Форматируем как +7XXXXXXXXXX
            this.value = value ? '+7' + value.substring(1) : '+7';
        });

        // Проверка паролей при вводе
        confirmPasswordInput.addEventListener('input', function() {
            const password = passwordInput.value;
            const confirmPassword = this.value;

            if (password && confirmPassword && password !== confirmPassword) {
                this.classList.add('input-error');
                showFieldError('confirm_password', 'Пароли не совпадают');
            } else {
                this.classList.remove('input-error');
                removeFieldError('confirm_password');
            }
        });

        // Обработка отправки формы
        form.addEventListener('submit', function(e) {
            e.preventDefault();

            let isValid = true;

            // Валидация имени
            const firstName = document.getElementById('first_name').value.trim();
            if (!/^[А-Яа-яЁё]{2,30}$/.test(firstName)) {
                showFieldError('first_name', 'Имя должно содержать только русские буквы (2-30 символов)');
                isValid = false;
            }

            // Валидация фамилии
            const lastName = document.getElementById('last_name').value.trim();
            if (!/^[А-Яа-яЁё]{2,30}$/.test(lastName)) {
                showFieldError('last_name', 'Фамилия должна содержать только русские буквы (2-30 символов)');
                isValid = false;
            }

            // Валидация телефона
            const phone = phoneInput.value.trim();
            if (!/^\+7\d{10}$/.test(phone)) {
                showFieldError('phone', 'Введите корректный номер телефона (+7XXXXXXXXXX)');
                isValid = false;
            }

            // Валидация email
            const email = document.getElementById('email').value.trim();
            const emailPattern = /^[a-zA-Z0-9._%+-]+@(mail\.ru|gmail\.com|yandex\.ru|yandex\.com|vk\.com)$/i;
            if (!emailPattern.test(email)) {
                showFieldError('email', 'Введите email с допустимым доменом (@mail.ru, @gmail.com, @yandex.ru, @vk.com)');
                isValid = false;
            }

            // Валидация пароля
            const password = passwordInput.value;
            const hasUpperCase = /[A-ZА-Я]/.test(password);
            const hasLowerCase = /[a-zа-я]/.test(password);
            const hasNumbers = /\d/.test(password);
            const hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/.test(password);

            if (password.length < 8) {
                showFieldError('password', 'Пароль должен быть не менее 8 символов');
                isValid = false;
            } else if (!hasUpperCase || !hasLowerCase || !hasNumbers || !hasSpecialChar) {
                showFieldError('password', 'Пароль должен содержать заглавные и строчные буквы, цифры и специальные символы');
                isValid = false;
            }

            // Проверка совпадения паролей
            const confirmPassword = confirmPasswordInput.value;
            if (password !== confirmPassword) {
                showFieldError('confirm_password', 'Пароли не совпадают');
                isValid = false;
            }

            // Проверка согласия с условиями
            const agreeTerms = document.getElementById('agree_terms').checked;
            if (!agreeTerms) {
                showFieldError('agree_terms', 'Необходимо согласиться с условиями использования');
                isValid = false;
            }

            if (isValid) {
                // Показываем индикатор загрузки
                submitBtn.disabled = true;
                const loadingIndicator = document.getElementById('loadingIndicator');
                if (loadingIndicator) loadingIndicator.style.display = 'flex';

                // Отправляем форму
                form.submit();
            } else {
                // Прокручиваем к первой ошибке
                const firstError = document.querySelector('.form-error');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        });

        // Функция для отображения ошибок
        function showFieldError(fieldId, message) {
            const field = document.getElementById(fieldId);
            if (field) {
                field.classList.add('input-error');

                let errorElement = field.parentElement.nextElementSibling;
                if (!errorElement || !errorElement.classList.contains('form-error')) {
                    errorElement = document.createElement('div');
                    errorElement.className = 'form-error';
                    errorElement.innerHTML = `<i class="bi bi-exclamation-circle me-1"></i>${message}`;
                    field.parentElement.parentElement.appendChild(errorElement);
                } else {
                    errorElement.innerHTML = `<i class="bi bi-exclamation-circle me-1"></i>${message}`;
                }
            }
        }

        // Функция для удаления ошибок
        function removeFieldError(fieldId) {
            const field = document.getElementById(fieldId);
            if (field) {
                field.classList.remove('input-error');

                const errorElement = field.parentElement.nextElementSibling;
                if (errorElement && errorElement.classList.contains('form-error')) {
                    errorElement.remove();
                }
            }
        }

        // Убираем ошибки при вводе
        const inputs = form.querySelectorAll('input');
        inputs.forEach(input => {
            input.addEventListener('input', function() {
                const fieldId = this.id;
                removeFieldError(fieldId);

                // Для чекбокса особый случай
                if (fieldId === 'agree_terms') {
                    this.classList.remove('input-error-check');
                }
            });
        });
    });
</script>

</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

<script>
    // Автоматическое скрытие успешных сообщений через 5 секунд
    document.addEventListener('DOMContentLoaded', function() {
        const alerts = document.querySelectorAll('.alert[data-autohide="true"]');
        alerts.forEach(alert => {
            setTimeout(() => {
                alert.classList.add('fade-out');
                setTimeout(() => {
                    if (alert.parentElement) {
                        alert.remove();
                    }
                }, 500);
            }, 5000);
        });

        // Закрытие по клику вне меню
        document.addEventListener('click', function(e) {
            const dropdowns = document.querySelectorAll('.dropdown-menu.show');
            dropdowns.forEach(dropdown => {
                if (!dropdown.previousElementSibling.contains(e.target)) {
                    const bsCollapse = new bootstrap.Collapse(dropdown.parentElement);
                    bsCollapse.hide();
                }
            });
        });

        // Анимация навбара при скролле
        let lastScroll = 0;
        const navbar = document.querySelector('.navbar');

        window.addEventListener('scroll', () => {
            const currentScroll = window.pageYOffset;

            if (currentScroll <= 0) {
                navbar.style.transform = 'translateY(0)';
                return;
            }

            if (currentScroll > lastScroll && currentScroll > 100) {
                navbar.style.transform = 'translateY(-100%)';
            } else {
                navbar.style.transform = 'translateY(0)';
            }

            lastScroll = currentScroll;
        });

        // Подсветка активной ссылки
        const navLinks = document.querySelectorAll('.nav-link');
        navLinks.forEach(link => {
            if (link.href === window.location.href) {
                link.classList.add('active');
            }
        });
    });
</script>
</body>
</html>
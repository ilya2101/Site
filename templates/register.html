{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert alert-{{ category }}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
{% endwith %}
{% extends "base.html" %}

{% block title %}Регистрация{% endblock %}

{% block body %}
    <div class="row justify-content-center">
        <div class="col-md-6">
            <h2 class="text-center mb-4">Регистрация</h2>
            <form action="{{ url_for('register') }}" method="POST">
                <!-- Имя -->
                <div class="mb-3">
                    <label for="first_name" class="form-label">Имя</label>
                    <input type="text" class="form-control" id="first_name" name="first_name" required>
                </div>
                <!-- Фамилия -->
                <div class="mb-3">
                    <label for="last_name" class="form-label">Фамилия</label>
                    <input type="text" class="form-control" id="last_name" name="last_name" required>
                </div>
                <!-- Номер телефона -->
                <div class="mb-3">
                    <label for="phone" class="form-label">Номер телефона</label>
                    <input type="tel" class="form-control" id="phone" name="phone" pattern="\+?[0-9\s\-]+" required>
                </div>
                <!-- Пароль -->
                <div class="mb-3">
                    <label for="password" class="form-label">Пароль</label>
                    <input type="password" class="form-control" id="password" name="password" minlength="6" required>
                </div>
                <!-- Подтверждение пароля -->
                <div class="mb-3">
                    <label for="confirm_password" class="form-label">Повторите пароль</label>
                    <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
                    <div id="password_error" class="text-danger" style="display: none;">Пароли не совпадают!</div>
                </div>
                <!-- Кнопка отправки -->
                <button type="submit" class="btn btn-primary w-100">Зарегистрироваться</button>
            </form>
            <!-- Ссылка на вход -->
            <div class="mt-3 text-center">
                <p>Уже есть аккаунт? <a href="{{ url_for('login') }}">Войти</a></p>
            </div>
        </div>
    </div>

    <!-- Проверка совпадения паролей -->
    <script>
        document.querySelector('form').addEventListener('submit', function(e) {
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirm_password').value;
            const errorElement = document.getElementById('password_error');

            if (password !== confirmPassword) {
                errorElement.style.display = 'block';
                e.preventDefault(); // Отмена отправки
            }
        });
    </script>
{% endblock %}